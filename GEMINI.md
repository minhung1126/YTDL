# GEMINI.md

## 工具使用

* 你可以隨時使用你手邊的工具，包括但不限於GoogleSearch,MCP Servers。

---

## 開發與發布慣例

這份文件記錄了我們為此專案建立的開發與維護流程。

### 1. 版本管理

- **檔案**: `YTDL.py`
- **變數**: `__version__`

專案的版本號由 `YTDL.py` 檔案中的 `__version__` 變數統一管理。

- **開發中**: 當您正在開發新功能或修復問題時，請將版本號設為 `"dev"`。
  ```python
  __version__ = "dev"
  ```
  這會讓程式在啟動時自動跳過版本更新檢查，避免干擾開發工作。

- **發布前**: 當您準備好要發布新版本時，請將版本號修改為一個具體的版本字串，例如 `"v2025.09.05"`。

### 2. 發布流程 (CI/CD)

- **檔案**: `.github/workflows/auto-release.yml`

本專案使用 GitHub Actions 實現自動化發布。

1.  當您將帶有新版本號的 `YTDL.py` 推送到 `main` 分支後，`auto-release` 工作流程會自動觸發。
2.  它會自動讀取 `YTDL.py` 中的 `__version__` 字串。
3.  使用這個字串作為標籤 (Tag)，在 GitHub 上建立一個對應的 Release。

這個流程確保了版本號的單一事實來源，並實現了全自動發布。

### 3. 使用者更新流程

- **觸發**: 使用者執行的 `YTDL.py` 或 `YTDL_mul.py`。
- **執行**: `self_update.py`

為了提供流暢的使用者體驗，我們設計了無縫的自動更新與重啟機制。

1.  當使用者啟動 `YTDL.py` 或 `YTDL_mul.py` 時，程式會首先檢查 GitHub 上的最新版本。
2.  如果發現新版本，程式會自動下載 `self_update.py` 並執行它，同時主程式退出。
3.  `self_update.py` 會下載最新版本的程式檔案並覆蓋舊檔。
4.  完成後，`self_update.py` 會**自動重新啟動**使用者當初執行的那個腳本 (`YTDL.py` 或 `YTDL_mul.py`)。

這個設計讓使用者幾乎感受不到更新過程，提升了整體體驗。

### 4. 依賴處理

考量到使用者是直接下載 `.py` 檔案執行，而非透過 `git` 或 `pip` 管理專案，我們採用了在執行時動態檢查並安裝依賴套件的策略。

- **方法**: 在 `import` 套件時使用 `try...except ImportError` 區塊。如果捕捉到錯誤，則使用 `subprocess` 呼叫 `pip` 來安裝該套件。
- **理由**: 這種「開箱即用」的模式對非開發者使用者最為友好，降低了使用門檻。